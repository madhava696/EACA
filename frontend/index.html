<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Emotion Aware Coding Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body
    class="bg-gray-100 text-gray-900 dark:bg-gray-900 dark:text-white min-h-screen flex flex-col"
  >
    <header
      class="p-4 bg-indigo-600 dark:bg-indigo-800 text-white flex justify-between items-center"
    >
      <h1 class="text-xl font-bold">Emotion Aware Coding Assistant</h1>
      <button
        id="themeToggle"
        class="px-3 py-1 rounded bg-white text-indigo-600 dark:bg-gray-700 dark:text-white"
      >
        Toggle Theme
      </button>
    </header>

    <main
      class="flex-1 container mx-auto p-4 grid grid-cols-1 md:grid-cols-2 gap-4"
    >
      <!-- Code Input -->
      <section>
        <h2 class="font-semibold mb-2">Enter Code / Text</h2>
        <textarea
          id="codeInput"
          rows="8"
          class="w-full p-2 border rounded dark:bg-gray-800 dark:border-gray-700"
        ></textarea>
        <button
          id="analyzeBtn"
          class="mt-2 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700"
        >
          Analyze Emotion
        </button>
      </section>

      <!-- Results -->
      <section>
        <h2 class="font-semibold mb-2">Detected Emotion</h2>
        <div
          id="result"
          class="p-4 border rounded bg-white dark:bg-gray-800 dark:border-gray-700 min-h-[4rem]"
          aria-live="polite"
        ></div>
        <button
          id="suggestionBtn"
          disabled
          class="mt-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"
        >
          Get Suggestion
        </button>
      </section>
    </main>

    <!-- Toolbox -->
    <aside class="fixed right-4 bottom-4">
      <button
        id="toolboxToggle"
        class="px-3 py-2 bg-gray-700 text-white rounded-full shadow"
      >
        ‚ò∞
      </button>
      <div
        id="toolbox"
        class="hidden mt-2 p-4 bg-white dark:bg-gray-800 rounded shadow w-48"
      >
        <h3 class="font-semibold mb-2">Toolbox</h3>
        <ul class="space-y-2 text-sm">
          <li>
            <button class="tool-btn w-full text-left">üìÑ Save Log</button>
          </li>
          <li><button class="tool-btn w-full text-left">üîÑ Clear</button></li>
          <li><button class="tool-btn w-full text-left">‚ùì Help</button></li>
        </ul>
      </div>
    </aside>

    <!-- Logs -->
    <section class="container mx-auto p-4">
      <h2 class="font-semibold mb-2">Emotion Logs</h2>
      <ul id="logList" class="space-y-1 text-sm"></ul>
    </section>

    <script>
      const codeInput = document.getElementById("codeInput");
      const analyzeBtn = document.getElementById("analyzeBtn");
      const resultDiv = document.getElementById("result");
      const suggestionBtn = document.getElementById("suggestionBtn");
      const logList = document.getElementById("logList");
      const themeToggle = document.getElementById("themeToggle");
      const toolboxToggle = document.getElementById("toolboxToggle");
      const toolbox = document.getElementById("toolbox");

      let currentEmotion = "";

      // Simple emotion detection
      function detectEmotion(text) {
        const lower = text.toLowerCase();
        if (lower.includes("error") || lower.includes("fail"))
          return "frustrated";
        if (lower.includes("love") || lower.includes("like")) return "happy";
        if (lower.includes("tired") || lower.includes("sleep")) return "tired";
        if (lower.includes("confuse") || lower.includes("don‚Äôt know"))
          return "confused";
        return "neutral";
      }

      // Emotion feedback
      function getFeedback(emotion) {
        const responses = {
          frustrated: { emoji: "üò§", msg: "Take a break, you‚Äôre doing great!" },
          happy: { emoji: "üòä", msg: "Keep up the good vibes!" },
          tired: { emoji: "üò¥", msg: "Maybe take some rest." },
          confused: {
            emoji: "ü§î",
            msg: "Try breaking the problem into smaller steps.",
          },
          neutral: { emoji: "üòê", msg: "Let‚Äôs keep going!" },
        };
        return responses[emotion] || responses.neutral;
      }

      // Analyze button
      analyzeBtn.addEventListener("click", () => {
        const text = codeInput.value.trim();
        if (!text) return;

        currentEmotion = detectEmotion(text);
        const feedback = getFeedback(currentEmotion);

        resultDiv.innerHTML = `${feedback.emoji} <strong>${currentEmotion}</strong>: ${feedback.msg}`;
        suggestionBtn.disabled = false;

        const logItem = document.createElement("li");
        logItem.className = "flex items-center gap-2";
        logItem.innerHTML = `
        <span>${feedback.emoji}</span> 
        <span class="capitalize">${currentEmotion}</span> 
        <span class="text-gray-500 italic">(${new Date().toLocaleTimeString()})</span>
      `;
        logList.prepend(logItem);
      });

      // Suggestion button
      suggestionBtn.addEventListener("click", () => {
        if (!currentEmotion) return;
        const feedback = getFeedback(currentEmotion);
        alert(`Suggestion: ${feedback.msg}`);
      });

      // Theme toggle
      themeToggle.addEventListener("click", () => {
        document.documentElement.classList.toggle("dark");
        localStorage.setItem(
          "theme",
          document.documentElement.classList.contains("dark") ? "dark" : "light"
        );
      });

      // Apply saved theme
      if (localStorage.getItem("theme") === "dark") {
        document.documentElement.classList.add("dark");
      }

      // Toolbox toggle
      toolboxToggle.addEventListener("click", (e) => {
        toolbox.classList.toggle("hidden");
        e.stopPropagation();
      });

      // Close toolbox if clicked outside
      document.addEventListener("click", (e) => {
        if (!toolbox.contains(e.target) && e.target !== toolboxToggle) {
          toolbox.classList.add("hidden");
        }
      });
    </script>
  </body>
</html>
